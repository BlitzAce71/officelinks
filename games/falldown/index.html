<!DOCTYPE html>
<html>
<head>
<title>Fall Down</title>
</head>
<body>
    <canvas id="gameCanvas" width="600" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let game = {
            ball: {
                x: canvas.width / 2,
                y: canvas.height / 2,
                radius: 10,
                dx: 0, // add an x velocity for the ball
                dy: 2
            },
            platforms: [],
            platformHeight: 10,
            gapWidth: 100,
            platformDistance: 100,
            platformSpeed: 1,
            generatePlatform: function(y) {
                let gapStart = Math.random() * (canvas.width - this.gapWidth);
                this.platforms.push({y, gapStart});
            }
        };

        game.generatePlatform(canvas.height - game.platformHeight);

        function drawBall() {
            ctx.beginPath();
            ctx.arc(game.ball.x, game.ball.y, game.ball.radius, 0, Math.PI*2);
            ctx.fillStyle = "#0095DD";
            ctx.fill();
            ctx.closePath();
        }

        function drawPlatforms() {
            for (let platform of game.platforms) {
                ctx.beginPath();
                ctx.rect(0, platform.y, platform.gapStart, game.platformHeight);
                ctx.rect(platform.gapStart + game.gapWidth, platform.y, canvas.width - platform.gapStart - game.gapWidth, game.platformHeight);
                ctx.fillStyle = "#0095DD";
                ctx.fill();
                ctx.closePath();
            }
        }

        function updateGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            drawBall();
            drawPlatforms();

            game.ball.x += game.ball.dx;
            game.ball.y += game.ball.dy;

            for (let platform of game.platforms) {
                platform.y -= game.platformSpeed;
            }

            if (game.platforms[0].y < 0) {
                game.platforms.shift();
                game.generatePlatform(canvas.height - game.platformHeight);
            }

            // check if the ball is hitting the left or right wall
            if (game.ball.x + game.ball.dx > canvas.width-game.ball.radius || game.ball.x + game.ball.dx < game.ball.radius) {
                game.ball.dx = -game.ball.dx;
            }

            requestAnimationFrame(updateGame);
        }

        updateGame();

        // add event listeners for keydown events
        document.addEventListener("keydown", keyDownHandler, false);

        function keyDownHandler(e) {
            if(e.key == "Right" || e.key == "ArrowRight") {
                game.ball.dx = 2;
            }
            else if(e.key == "Left" || e.key == "ArrowLeft") {
                game.ball.dx = -2;
            }
        }
    </script>
</body>
</html>
